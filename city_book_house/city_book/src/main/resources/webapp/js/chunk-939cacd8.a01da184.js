(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-939cacd8"],{"0be4":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"reader"},[a("div",{staticClass:"nav"},[a("a-breadcrumb",[a("a-breadcrumb-item",[a("router-link",{attrs:{to:"/admin/home"}},[t._v("首页")])],1),a("a-breadcrumb-item",[t._v("读者管理")])],1)],1),a("div",{staticClass:"manage"},[a("a-form",{staticClass:"margin_bottom_20",attrs:{layout:"inline"}},[a("a-form-item",{attrs:{label:"姓名"}},[a("a-input",{model:{value:t.params.name,callback:function(e){t.$set(t.params,"name",e)},expression:"params.name"}})],1),a("a-form-item",{attrs:{label:"手机"}},[a("a-input",{model:{value:t.params.phone,callback:function(e){t.$set(t.params,"phone",e)},expression:"params.phone"}})],1),a("a-form-item",{attrs:{label:"用户状态"}},[a("a-select",{attrs:{options:t.status,allowClear:""},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}})],1),a("a-form-item",{attrs:{label:"用户权限"}},[a("a-select",{attrs:{options:t.auth,allowClear:""},model:{value:t.params.auth,callback:function(e){t.$set(t.params,"auth",e)},expression:"params.auth"}})],1),a("a-form-item",[a("a-button",{staticStyle:{"margin-right":"12px"},attrs:{type:"primary"},on:{click:function(e){return t.$refs.table.refresh(!0)}}},[t._v("搜索")]),a("a-button",{on:{click:t.reset}},[t._v("重置")])],1)],1)],1),a("div",{staticClass:"btn_group margin_bottom_20"},[a("a-button",{attrs:{type:"primary"},on:{click:t.toExamine}},[t._v("读者审核")]),a("div",[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.banReader(t.selectedRowKeys,2)}}},[t._v("批量禁用")]),a("a-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:function(e){return t.banReader(t.selectedRowKeys,1)}}},[t._v("批量启用")])],1)],1),a("s-table",{ref:"table",attrs:{bordered:"",size:"default","row-key":"id",columns:t.columns,data:t.loadData,"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange}},scopedSlots:t._u([{key:"gender",fn:function(e){return[t._v(" "+t._s(1===e.gender?"男":"女")+" ")]}},{key:"auth",fn:function(e){return[t._v(" "+t._s(1===e.auth?"正常":2===e.auth?"已禁用":"申请中")+" ")]}},{key:"status",fn:function(e){return[t._v(" "+t._s(t.formatStatus(e.status))+" ")]}},{key:"action",fn:function(e){return[a("a-button",{attrs:{type:"link"},on:{click:function(a){return t.viewReader(e.id)}}},[t._v("查看")]),3!==e.auth?a("a-button",{attrs:{type:"link"},on:{click:function(a){return t.banReader(e)}}},[t._v(t._s(1===e.auth?"禁用":"启用"))]):t._e()]}}])}),a("a-modal",{attrs:{footer:null,title:"读者详情",width:"50%"},model:{value:t.readerDetailVisible,callback:function(e){t.readerDetailVisible=e},expression:"readerDetailVisible"}},[a("a-row",{staticClass:"reader_row"},[a("a-col",[a("span",[t._v("姓名：")]),a("span",[t._v(t._s(t.readerDetail.name))])]),a("a-col",[a("span",[t._v("手机：")]),a("span",[t._v(t._s(t.readerDetail.phone))])]),a("a-col",[a("span",[t._v("身份证号：")]),a("span",[t._v(t._s(t.readerDetail.code))])]),a("a-col",[a("span",[t._v("用户状态：")]),a("span",[t._v(t._s(t.formatStatus(t.readerDetail.status)))])]),a("a-col",[a("span",[t._v("身份证照片：")]),a("span",[t._v("安全与健康")])])],1),a("h2",[t._v("借阅记录")]),t.recordList.length>0?a("div",[t._l(t.recordList,(function(e){return[a("div",{key:e.id},[a("a-row",[a("a-col",{attrs:{span:6}},[t._v("时间")]),a("a-col",{attrs:{span:6}},[t._v("操作")]),a("a-col",{attrs:{span:6}},[t._v("书籍")]),a("a-col",{attrs:{span:6}},[t._v("状态")])],1),a("a-row",[[a("a-col",{attrs:{span:6}},[t._v(t._s(e.create_time))]),a("a-col",{attrs:{span:6}},[t._v(t._s(t.formatTime(e.end_time)))]),a("a-col",{attrs:{span:6}},[t._v(t._s(e.book.book_name))]),a("a-col",{attrs:{span:6}},[t._v(t._s(t.formatStatus(e.status)))])]],2)],1)]}))],2):a("div",[t._v(" 暂时没有记录 ")])],1)],1)},r=[],o=(a("a9e3"),a("d3b7"),a("3ca3"),a("ddb0"),a("2909")),i=a("5530"),s=a("ab09"),c=a("2f62"),u={name:"Reader",components:{STable:s["a"]},data:function(){var t=this,e=[{title:"id",dataIndex:"id"},{title:"姓名",dataIndex:"name"},{title:"性别",scopedSlots:{customRender:"gender"}},{title:"手机",dataIndex:"phone"},{title:"用户状态",scopedSlots:{customRender:"status"}},{title:"用户权限",scopedSlots:{customRender:"auth"}},{title:"操作",width:"250px",scopedSlots:{customRender:"action"}}],a={status:"",name:"",phone:"",auth:""},n={offset:0,limit:10,book_id:null};return{columns:e,params:a,recordParams:n,readerDetailVisible:!1,selectedRowKeys:[],loadData:function(e){return t.getReaderList(Object.assign({},t.params,e))}}},computed:Object(i["a"])(Object(i["a"])({},Object(c["c"])("reader",["readerDetail","recordList"])),{},{formatStatus:function(){return function(t){return 1===t?"正常":2===t?"已禁用":"未审核"}},formatTime:function(){return function(t){var e=Number((new Date).getTime()/86e6),a=Number(new Date(t).getTime()/86e6);return e-a>0?"超时".concat(Math.floor(e-a),"天"):"正常"}},status:function(){return[{label:"全部",value:""},{label:"正常",value:1},{label:"已禁用",value:2}]},auth:function(){return[{label:"全部",value:""},{label:"正常",value:1},{label:"已禁用",value:2}]}}),methods:Object(i["a"])(Object(i["a"])({},Object(c["b"])("reader",{getReaderList:"getReaderList",getReaderDetail:"getReaderDetail",getReaderRecord:"getReaderRecord",ban:"ban"})),{},{viewReader:function(t){var e=this;this.recordParams.book_id=t,Promise.all([this.getReaderDetail(t),this.getReaderRecord(this.recordParams)]).then((function(t){e.readerDetailVisible=!0}))},banReader:function(t,e){var a=this,n=[];t instanceof Array?n=Object(o["a"])(t):(n.push(t.id),e=1===t.auth?2:1),this.ban({id:n,auth:e}).then((function(t){a.$message.success("操作成功"),a.$refs.table.refresh(!0)}))},toExamine:function(){this.$router.push({name:"Reader Examine"})},reset:function(){this.params={status:"",name:"",phone:"",auth:""},this.$refs.table.refresh(!0)},onSelectChange:function(t){this.selectedRowKeys=t}})},l=u,f=(a("7dac"),a("2877")),d=Object(f["a"])(l,n,r,!1,null,"4940434b",null);e["default"]=d.exports},"159b":function(t,e,a){var n=a("da84"),r=a("fdbc"),o=a("17c2"),i=a("9112");for(var s in r){var c=n[s],u=c&&c.prototype;if(u&&u.forEach!==o)try{i(u,"forEach",o)}catch(l){u.forEach=o}}},"17c2":function(t,e,a){"use strict";var n=a("b727").forEach,r=a("a640"),o=a("ae40"),i=r("forEach"),s=o("forEach");t.exports=i&&s?[].forEach:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}},2532:function(t,e,a){"use strict";var n=a("23e7"),r=a("5a34"),o=a("1d80"),i=a("ab13");n({target:"String",proto:!0,forced:!i("includes")},{includes:function(t){return!!~String(o(this)).indexOf(r(t),arguments.length>1?arguments[1]:void 0)}})},2638:function(t,e,a){"use strict";function n(){return n=Object.assign||function(t){for(var e,a=1;a<arguments.length;a++)for(var n in e=arguments[a],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},n.apply(this,arguments)}var r=["attrs","props","domProps"],o=["class","style","directives"],i=["on","nativeOn"],s=function(t){return t.reduce((function(t,e){for(var a in e)if(t[a])if(-1!==r.indexOf(a))t[a]=n({},t[a],e[a]);else if(-1!==o.indexOf(a)){var s=t[a]instanceof Array?t[a]:[t[a]],u=e[a]instanceof Array?e[a]:[e[a]];t[a]=s.concat(u)}else if(-1!==i.indexOf(a))for(var l in e[a])if(t[a][l]){var f=t[a][l]instanceof Array?t[a][l]:[t[a][l]],d=e[a][l]instanceof Array?e[a][l]:[e[a][l]];t[a][l]=f.concat(d)}else t[a][l]=e[a][l];else if("hook"==a)for(var p in e[a])t[a][p]=t[a][p]?c(t[a][p],e[a][p]):e[a][p];else t[a]=e[a];else t[a]=e[a];return t}),{})},c=function(t,e){return function(){t&&t.apply(this,arguments),e&&e.apply(this,arguments)}};t.exports=s},4160:function(t,e,a){"use strict";var n=a("23e7"),r=a("17c2");n({target:"Array",proto:!0,forced:[].forEach!=r},{forEach:r})},"4de4":function(t,e,a){"use strict";var n=a("23e7"),r=a("b727").filter,o=a("1dde"),i=a("ae40"),s=o("filter"),c=i("filter");n({target:"Array",proto:!0,forced:!s||!c},{filter:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},5530:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));a("a4d3"),a("4de4"),a("4160"),a("e439"),a("dbb4"),a("b64b"),a("159b");var n=a("ade3");function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){Object(n["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var n=a("1d80"),r=a("5899"),o="["+r+"]",i=RegExp("^"+o+o+"*"),s=RegExp(o+o+"*$"),c=function(t){return function(e){var a=String(n(e));return 1&t&&(a=a.replace(i,"")),2&t&&(a=a.replace(s,"")),a}};t.exports={start:c(1),end:c(2),trim:c(3)}},"5a34":function(t,e,a){var n=a("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},"680a":function(t,e,a){},7156:function(t,e,a){var n=a("861d"),r=a("d2bb");t.exports=function(t,e,a){var o,i;return r&&"function"==typeof(o=e.constructor)&&o!==a&&n(i=o.prototype)&&i!==a.prototype&&r(t,i),t}},"7dac":function(t,e,a){"use strict";a("680a")},a9e3:function(t,e,a){"use strict";var n=a("83ab"),r=a("da84"),o=a("94ca"),i=a("6eeb"),s=a("5135"),c=a("c6b6"),u=a("7156"),l=a("c04e"),f=a("d039"),d=a("7c73"),p=a("241c").f,h=a("06cf").f,b=a("9bf2").f,g=a("58a8").trim,m="Number",v=r[m],y=v.prototype,O=c(d(y))==m,_=function(t){var e,a,n,r,o,i,s,c,u=l(t,!1);if("string"==typeof u&&u.length>2)if(u=g(u),e=u.charCodeAt(0),43===e||45===e){if(a=u.charCodeAt(2),88===a||120===a)return NaN}else if(48===e){switch(u.charCodeAt(1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+u}for(o=u.slice(2),i=o.length,s=0;s<i;s++)if(c=o.charCodeAt(s),c<48||c>r)return NaN;return parseInt(o,n)}return+u};if(o(m,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var w,S=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof S&&(O?f((function(){y.valueOf.call(a)})):c(a)!=m)?u(new v(_(e)),a,S):_(e)},j=n?p(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),P=0;j.length>P;P++)s(v,w=j[P])&&!s(S,w)&&b(S,w,h(v,w));S.prototype=y,y.constructor=S,i(r,m,S)}},ab09:function(t,e,a){"use strict";a("99af"),a("4160"),a("caad"),a("d81d"),a("b0c0"),a("a9e3"),a("b64b"),a("2532"),a("159b");var n=a("2638"),r=a.n(n),o=a("53ca"),i=a("5530"),s=a("372e");e["a"]={data:function(){return{localLoading:!1,localDataSource:[],localPagination:Object.assign({},this.pagination)}},props:Object.assign({},s["a"].props,{rowKey:{type:[String,Function],default:"key"},data:{type:Function,required:!0},pageNum:{type:Number,default:1},pageSize:{type:Number,default:10},showSizeChanger:{type:Boolean,default:!0},size:{type:String,default:"default"},alert:{type:[Object,Boolean],default:null},rowSelection:{type:Object,default:null},showAlertInfo:{type:Boolean,default:!1},showPagination:{type:String|Boolean,default:"auto"},pageURI:{type:Boolean,default:!1}}),watch:{"localPagination.current":function(t){this.pageURI&&this.$router.push(Object(i["a"])(Object(i["a"])({},this.$route),{},{name:this.$route.name,params:Object.assign({},this.$route.params,{pageNo:t})}))},pageNum:function(t){Object.assign(this.localPagination,{current:t})},pageSize:function(t){Object.assign(this.localPagination,{pageSize:t})},showSizeChanger:function(t){Object.assign(this.localPagination,{showSizeChanger:t})}},created:function(){var t=this.$route.params.pageNo,e=this.pageURI&&t&&parseInt(t)||this.pageNum;this.localPagination=["auto",!0].includes(this.showPagination)&&Object.assign({},this.localPagination,{current:e,pageSize:this.pageSize,showSizeChanger:this.showSizeChanger})||!1,this.loadData()},methods:{refresh:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(this.localPagination=Object.assign({},{current:1,pageSize:this.pageSize})),this.loadData()},loadData:function(t,e,a){var n=this;this.localLoading=!0;var r=Object.assign({offset:10*(Number(t&&t.current||this.showPagination&&this.localPagination.current)-1)||10*(Number(this.pageNum)-1),limit:t&&t.pageSize||this.showPagination&&this.localPagination.pageSize||this.pageSize},a&&a.field&&{sortField:a.field}||{},a&&a.order&&{sortOrder:a.order}||{},Object(i["a"])({},e)),s=this.data(r);"object"!==Object(o["a"])(s)&&"function"!==typeof s||"function"!==typeof s.then||s.then((function(e){if(n.localPagination=n.showPagination&&Object.assign({},n.localPagination,{current:r.offset/10+1,total:e.total,showSizeChanger:n.showSizeChanger,pageSize:t&&t.pageSize||n.localPagination.pageSize})||!1,e.list&&0===e.list.length&&n.showPagination&&n.localPagination.current>1)return n.localPagination.current--,void n.loadData();try{["auto",!0].includes(n.showPagination)&&e.totalCount<=e.pageNo*n.localPagination.pageSize&&(n.localPagination.hideOnSinglePage=!0)}catch(a){n.localPagination=!1}n.localDataSource=e.list||e,n.localLoading=!1}))},initTotalList:function(t){var e=[];return t&&t instanceof Array&&t.forEach((function(t){t.needTotal&&e.push(Object(i["a"])(Object(i["a"])({},t),{},{total:0}))})),e}},render:function(){var t=this,e=arguments[0],a={},n=Object.keys(this.$data);Object.keys(s["a"].props).forEach((function(e){var r="local".concat(e.substring(0,1).toUpperCase()).concat(e.substring(1));return n.includes(r)?(a[e]=t[r],a[e]):(t[e]&&(a[e]=t[e]),a[e])}));var o=e("a-table",r()([{},{props:a,scopedSlots:Object(i["a"])({},this.$scopedSlots)},{on:{change:this.loadData,expand:function(e,a){t.$emit("expand",e,a)}}}]),[Object.keys(this.$slots).map((function(a){return e("template",{slot:a},[t.$slots[a]])}))]);return e("div",{class:"table-wrapper"},[o])}}},ab13:function(t,e,a){var n=a("b622"),r=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[r]=!1,"/./"[t](e)}catch(n){}}return!1}},ade3:function(t,e,a){"use strict";function n(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a.d(e,"a",(function(){return n}))},b64b:function(t,e,a){var n=a("23e7"),r=a("7b0b"),o=a("df75"),i=a("d039"),s=i((function(){o(1)}));n({target:"Object",stat:!0,forced:s},{keys:function(t){return o(r(t))}})},caad:function(t,e,a){"use strict";var n=a("23e7"),r=a("4d64").includes,o=a("44d2"),i=a("ae40"),s=i("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:!s},{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},d81d:function(t,e,a){"use strict";var n=a("23e7"),r=a("b727").map,o=a("1dde"),i=a("ae40"),s=o("map"),c=i("map");n({target:"Array",proto:!0,forced:!s||!c},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},dbb4:function(t,e,a){var n=a("23e7"),r=a("83ab"),o=a("56ef"),i=a("fc6a"),s=a("06cf"),c=a("8418");n({target:"Object",stat:!0,sham:!r},{getOwnPropertyDescriptors:function(t){var e,a,n=i(t),r=s.f,u=o(n),l={},f=0;while(u.length>f)a=r(n,e=u[f++]),void 0!==a&&c(l,e,a);return l}})},e439:function(t,e,a){var n=a("23e7"),r=a("d039"),o=a("fc6a"),i=a("06cf").f,s=a("83ab"),c=r((function(){i(1)})),u=!s||c;n({target:"Object",stat:!0,forced:u,sham:!s},{getOwnPropertyDescriptor:function(t,e){return i(o(t),e)}})}}]);
//# sourceMappingURL=chunk-939cacd8.a01da184.js.map