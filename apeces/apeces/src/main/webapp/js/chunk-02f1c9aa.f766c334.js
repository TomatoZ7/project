(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02f1c9aa"],{"318c":function(t,e,i){"use strict";i("3854")},3854:function(t,e,i){},e15c:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h2",[t._v("产品管理")]),i("a-row",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"flex"}},[i("a-col",{staticStyle:{width:"100%",display:"flex"}},[i("a-button",{attrs:{type:"primary"},on:{click:t.popProduct}},[t._v("添加产品")])],1)],1),i("s-table",{ref:"table",attrs:{bordered:"",size:"default","row-key":"id",columns:t.columns,data:t.loadData},scopedSlots:t._u([{key:"action",fn:function(e){return[i("a-button",{attrs:{type:"link"},on:{click:function(i){return t.toEdit(e.id)}}},[t._v("编辑")]),i("a-button",{attrs:{type:"link"},on:{click:function(i){return t.toDelete(e.id)}}},[t._v("删除")])]}}])}),i("a-modal",{attrs:{title:t.isEdit?"编辑产品":"添加产品",width:"60%",okButtonProps:{props:{loading:t.submitLoading}}},on:{ok:t.handleSubmit},model:{value:t.productVisible,callback:function(e){t.productVisible=e},expression:"productVisible"}},[i("a-spin",{attrs:{spinning:t.modalLoading}},[i("a-form",[i("a-form-item",{attrs:{label:"产品名称"}},[i("a-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),i("a-form-item",{attrs:{label:"介绍"}},[i("a-input",{model:{value:t.form.introduction,callback:function(e){t.$set(t.form,"introduction",e)},expression:"form.introduction"}})],1),i("a-form-item",{attrs:{label:"产品封面"}},[i("a-upload",{staticClass:"avatar-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,action:t.uploadPrefix+"/upload"},on:{change:t.hanldeCoverChange}},[t.form.cover_img?i("div",{staticClass:"bg_img cover_img",style:"background-image: url("+t.imgPrefix+t.form.cover_img+");"}):i("div",[i("a-icon",{attrs:{type:t.coverLoading?"loading":"plus"}}),i("div",{staticClass:"ant-upload-text"},[t._v(" Upload ")])],1)])],1),i("a-form-item",{attrs:{label:"产品详情图"}},[i("a-upload",{staticClass:"avatar-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,action:t.uploadPrefix+"/upload"},on:{change:t.hanldeDetailChange}},[t.form.detail_img?i("div",{staticClass:"bg_img cover_img",style:"background-image: url("+t.imgPrefix+t.form.detail_img+");"}):i("div",[i("a-icon",{attrs:{type:t.detailLoading?"loading":"plus"}}),i("div",{staticClass:"ant-upload-text"},[t._v(" Upload ")])],1)])],1),i("a-form-item",{attrs:{label:"所属分类"}},[i("a-select",{attrs:{options:t.category},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}})],1),i("a-form-item",{attrs:{label:"数量",type:"number"}},[i("a-input-number",{model:{value:t.form.nums,callback:function(e){t.$set(t.form,"nums",e)},expression:"form.nums"}})],1),i("a-form-item",{attrs:{label:"价格",type:"number"}},[i("a-input-number",{model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1),i("a-form-item",{attrs:{label:"单位"}},[i("a-input",{model:{value:t.form.unit,callback:function(e){t.$set(t.form,"unit",e)},expression:"form.unit"}})],1)],1)],1)],1)],1)},o=[],n=(i("d81d"),i("a9e3"),i("d3b7"),i("5530")),r=i("ab09"),s=i("2f62"),d=function(){return{keyword:""}},c=function(){return{name:"",introduction:"",category_id:void 0,nums:0,price:0,unit:"",cover_img:"",detail_img:""}},l={components:{STable:r["a"]},data:function(){var t=this,e=[{title:"id",dataIndex:"id"},{title:"名字",dataIndex:"name"},{title:"介绍",dataIndex:"introduction"},{title:"所属分类",dataIndex:"category_name"},{title:"数量",dataIndex:"nums"},{title:"价格",dataIndex:"price"},{title:"单位",dataIndex:"unit"},{title:"操作",scopedSlots:{customRender:"action"}}];return{columns:e,searchParams:d(),productVisible:!1,isEdit:!1,submitLoading:!1,modalLoading:!1,form:c(),proxy:"/apeces/admin",prefix:"/",imgPrefix:"/apeces_file",uploadPrefix:"/apeces",coverLoading:!1,detailLoading:!1,loadData:function(e){return t.getProductList(Object.assign({},e,{shop_id:sessionStorage.getItem("shop_id")?Number(sessionStorage.getItem("shop_id")):void 0}))}}},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(s["c"])("product",["detail"])),Object(s["c"])("category",{categoryList:"list"})),{},{category:function(){return 0===this.categoryList.length?[]:this.categoryList.map((function(t){return{label:t.category_name,value:t.id}}))}}),watch:{productVisible:function(){this.productVisible||(this.form=c())}},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(s["b"])("product",{getProductList:"getList",addProduct:"add",updateProduct:"update",getProductDetail:"getDetail",deleteProduct:"delete"})),Object(s["b"])("category",{getCategoryList:"getList"})),{},{toEdit:function(t){var e=this;this.isEdit=!0,this.modalLoading=!0,this.productVisible=!0,this.getProductDetail(t).then((function(t){e.form=Object.assign({},e.form,t.data)})).finally((function(){e.modalLoading=!1}))},toDelete:function(t){var e=this;this.$confirm({content:"你确定要删除这个产品？",okText:"确认",cancelText:"取消",onOk:function(){e.deleteProduct(t).then((function(t){e.$refs.table.refresh(!0)}))}})},popProduct:function(){this.isEdit=!1,this.form=c(),this.productVisible=!0},hanldeCoverChange:function(t){var e=t.file;"uploading"===e.status&&(this.form.cover_img="",this.coverLoading=!0),"done"===e.status&&(this.form.cover_img=e.response.data,this.coverLoading=!1)},hanldeDetailChange:function(t){var e=t.file;"uploading"===e.status&&(this.form.detail_img="",this.detailLoading=!0),"done"===e.status&&(this.form.detail_img=e.response.data,this.detailLoading=!1)},handleSubmit:function(){var t=this;this.modalLoading?this.productVisible=!1:(this.form.shop_id=Number(sessionStorage.getItem("shop_id")),this.form.shop_id?(this.submitLoading=!0,this.isEdit?this.updateProduct({id:this.form.id,data:this.form}).then((function(){t.$message.success("修改成功"),t.$refs.table.refresh(!0),t.productVisible=!1})).finally((function(){t.submitLoading=!1})):this.addProduct(this.form).then((function(){t.$message.success("添加成功"),t.$refs.table.refresh(!0),t.productVisible=!1})).finally((function(){t.submitLoading=!1}))):this.$message.error("商户id丢失"))}}),created:function(){this.getCategoryList({limit:-1})}},u=l,m=(i("318c"),i("2877")),f=Object(m["a"])(u,a,o,!1,null,"57088f57",null);e["default"]=f.exports}}]);
//# sourceMappingURL=chunk-02f1c9aa.f766c334.js.map