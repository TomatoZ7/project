(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f24850f6"],{a6cf:function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h2",[t._v("产品管理")]),i("a-row",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"flex"}},[i("a-col",{staticStyle:{width:"100%",display:"flex"}},[i("a-button",{attrs:{type:"primary"},on:{click:t.popNews}},[t._v("添加广告")])],1)],1),i("s-table",{ref:"table",attrs:{bordered:"",size:"default","row-key":"id",columns:t.columns,data:t.loadData},scopedSlots:t._u([{key:"cover",fn:function(e){return[i("div",{staticClass:"bg_img",style:"background-image: url("+t.imgPrefix+e.cover_img+"); width: 148px; height: 148px;"})]}},{key:"action",fn:function(e){return[i("a-button",{attrs:{type:"link"},on:{click:function(i){return t.toEdit(e.id)}}},[t._v("编辑")]),i("a-button",{attrs:{type:"link"},on:{click:function(i){return t.toDelete(e.id)}}},[t._v("删除")])]}}])}),i("a-modal",{attrs:{title:t.isEdit?"编辑产品":"添加产品",width:"60%",okButtonProps:{props:{loading:t.submitLoading}}},on:{ok:t.handleSubmit},model:{value:t.newsVisible,callback:function(e){t.newsVisible=e},expression:"newsVisible"}},[i("a-spin",{attrs:{spinning:t.modalLoading}},[i("a-form",[i("a-form-item",{attrs:{label:"广告标题"}},[i("a-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),i("a-form-item",{attrs:{label:"广告内容"}},[i("a-input",{model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),i("a-form-item",{attrs:{label:"广告封面"}},[i("a-upload",{staticClass:"avatar-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,action:t.uploadPrefix+"/upload"},on:{change:t.hanldeCoverChange}},[t.form.cover_img?i("div",{staticClass:"bg_img cover_img",style:"background-image: url("+t.imgPrefix+t.form.cover_img+");"}):i("div",[i("a-icon",{attrs:{type:t.coverLoading?"loading":"plus"}}),i("div",{staticClass:"ant-upload-text"},[t._v(" Upload ")])],1)])],1),i("a-form-item",{attrs:{label:"关联产品"}},[i("a-select",{attrs:{options:t.product},model:{value:t.form.product_id,callback:function(e){t.$set(t.form,"product_id",e)},expression:"form.product_id"}})],1)],1)],1)],1)],1)},s=[],a=(i("d81d"),i("b0c0"),i("a9e3"),i("d3b7"),i("5530")),n=i("ab09"),r=i("2f62"),d=function(){return{keyword:""}},c=function(){return{title:"",cover_img:"",content:"",product_id:"",shop_id:""}},l={components:{STable:n["a"]},data:function(){var t=this,e=[{title:"id",dataIndex:"id"},{title:"标题",dataIndex:"title"},{title:"内容",dataIndex:"content"},{title:"封面图",scopedSlots:{customRender:"cover"}},{title:"操作",scopedSlots:{customRender:"action"}}];return{columns:e,searchParams:d(),newsVisible:!1,isEdit:!1,submitLoading:!1,modalLoading:!1,form:c(),proxy:"/apeces/admin",prefix:"/",imgPrefix:"/apeces_file",uploadPrefix:"/apeces",coverLoading:!1,loadData:function(e){return t.getNewsList(Object.assign({},e,{shop_id:sessionStorage.getItem("shop_id")?Number(sessionStorage.getItem("shop_id")):void 0}))}}},computed:Object(a["a"])(Object(a["a"])(Object(a["a"])({},Object(r["c"])("advertisement",["detail"])),Object(r["c"])("product",{productList:"list"})),{},{product:function(){return 0===this.productList.length?[]:this.productList.map((function(t){return{label:t.name,value:t.id}}))}}),watch:{newsVisible:function(){this.newsVisible||(this.form=c())}},methods:Object(a["a"])(Object(a["a"])(Object(a["a"])({},Object(r["b"])("advertisement",{getNewsList:"getList",addNews:"add",updateNews:"update",getNewsDetail:"getDetail",deleteNews:"delete"})),Object(r["b"])("product",{getProductList:"getList"})),{},{toEdit:function(t){var e=this;this.isEdit=!0,this.modalLoading=!0,this.newsVisible=!0,this.getNewsDetail(t).then((function(t){e.form=Object.assign({},e.form,t.data),e.form.product_id=t.data.product.id})).finally((function(){e.modalLoading=!1}))},toDelete:function(t){var e=this;this.$confirm({content:"你确定要删除这个产品？",okText:"确认",cancelText:"取消",onOk:function(){e.deleteNews(t).then((function(t){e.$refs.table.refresh(!0)}))}})},popNews:function(){this.isEdit=!1,this.form=c(),this.newsVisible=!0},hanldeCoverChange:function(t){var e=t.file;"uploading"===e.status&&(this.form.cover_img="",this.coverLoading=!0),"done"===e.status&&(this.form.cover_img=e.response.data,this.coverLoading=!1)},handleSubmit:function(){var t=this;this.modalLoading?this.newsVisible=!1:(this.form.shop_id=Number(sessionStorage.getItem("shop_id")),this.form.shop_id?(this.submitLoading=!0,this.isEdit?this.updateNews({id:this.form.id,data:this.form}).then((function(){t.$message.success("修改成功"),t.$refs.table.refresh(!0),t.newsVisible=!1})).finally((function(){t.submitLoading=!1})):this.addNews(this.form).then((function(){t.$message.success("添加成功"),t.$refs.table.refresh(!0),t.newsVisible=!1})).finally((function(){t.submitLoading=!1}))):this.$message.error("商户id丢失"))}}),created:function(){this.getProductList({limit:-1})}},u=l,f=(i("aada"),i("2877")),m=Object(f["a"])(u,o,s,!1,null,"7e5e3eb7",null);e["default"]=m.exports},aada:function(t,e,i){"use strict";i("dbb5")},dbb5:function(t,e,i){}}]);
//# sourceMappingURL=chunk-f24850f6.5f5cb1b3.js.map